# Vly 功能需求文档

> 版本: 2.0  
> 更新日期: 2026-02-07  
> 状态: **KSPlayer + FFmpeg (GPL)**  

---

## ⚠️ 核心约束

| 约束 | 要求 |
|------|------|
| **播放器** | 必须使用 KSPlayer + FFmpeg (GPL) |
| **最高分辨率** | 4K |
| **项目类型** | 开源 (GPL 协议) |
| **放弃条件** | 只用 AVPlayer → 项目放弃 |

---

## 1. 概述

Vly 是一个简洁优雅的 macOS/iOS 视频播放器，基于 KSPlayer + FFmpeg 内核，支持多格式播放。

**定位**：linfuse 的播放器内核，提供强大的解码能力和简洁的界面。

---

## 2. 功能清单

### 2.1 基础播放 ✅

| 功能 | 说明 | 状态 |
|------|------|------|
| **播放/暂停** | ⭐ 基础 | ✅ |
| **进度条拖拽** | ⭐ 基础 | ✅ |
| **快进/快退** | 15秒跳转 | ✅ |
| **音量控制** | 调节音量 | ✅ |
| **全屏播放** | ⭐ 基础 | ✅ |
| **循环播放** | 单曲/列表循环 | ✅ |
| **静音切换** | 🔇 | ✅ |

---

### 2.2 多格式支持 ✅

| 格式 | 编码 | 状态 |
|------|------|------|
| **MP4** | H.264/H.265 | ✅ |
| **MKV** | 多编码 | ✅ |
| **AVI** | 多编码 | ✅ |
| **FLV** | H.264/AAC | ✅ |
| **WebM** | VP8/VP9 | ✅ |
| **WMV** | WMV2/3 | ✅ |
| **MOV** | ProRes/无损 | ✅ |
| **3GP** | H.263/AAC | ✅ |
| **AV1** | ⚠️ 软解 | ✅ |
| **最高分辨率** | **4K** | ✅ |

---

### 2.3 字幕支持 ✅

| 功能 | 说明 | 状态 |
|------|------|------|
| **SRT 字幕** | 基础文本 | ✅ |
| **ASS/SSA 字幕** | 高级样式 | ✅ |
| **SUB 字幕** | 图像字幕 | ✅ |
| **内嵌字幕** | MP4/MKV 内置 | ✅ |
| **外挂字幕** | 单独文件加载 | ✅ |
| **在线字幕搜索** | 自动匹配 | ✅ |
| **Closed Captions** | 电视字幕 | ✅ |
| **字幕编码** | UTF-8/GBK/Big5 | ✅ |
| **字幕大小** | 字体调节 | ✅ |
| **字幕位置** | 上/中/下 | ✅ |

---

### 2.4 网络播放 ✅

| 功能 | 说明 | 状态 |
|------|------|------|
| **SMB** | 局域网共享 | ✅ |
| **NFS** | 局域网共享 | ✅ |
| **UPnP/DLNA** | 媒体服务器 | ✅ |
| **WebDAV** | 通用协议 | ✅ |

---

### 2.5 系统集成 ✅

| 功能 | 说明 | 状态 |
|------|------|------|
| **画中画 (PiP)** | 小窗口播放 | ✅ |
| **进度记忆** | 记住观看位置 | ✅ |
| **拖放打开** | 拖文件到播放器 | ✅ |
| **右键菜单** | 快速操作 | ✅ |
| **Touch Bar** | Mac 触控栏 | ✅ |
| **快捷键** | 空格全屏等 | ✅ |

---

### 2.6 播放器控制 ✅

| 功能 | 说明 | 状态 |
|------|------|------|
| **亮度调节** | 屏幕亮度 | ✅ |
| **对比度/饱和度** | 画面调整 | ✅ |
| **倍速播放** | 0.5x/1x/1.5x/2x | ✅ |
| **硬件加速** | GPU 加速 | ✅ |
| **截图** | 📸 截取画面 | ✅ |

---

## 3. ❌ 不支持的功能

| 功能 | 原因 |
|------|------|
| **8K 播放** | GPL 限制 |
| **120FPS** | GPL 限制 |
| **AV1 硬解** | GPL 限制 |
| **Dolby AC-4** | GPL 限制 |
| **高级 ASS 特效** | 需要 libass (LGPL) |
| **逐字特效字幕** | LGPL 付费 |
| **SUP 图片字幕** | LGPL 付费 |
| **双语字幕** | LGPL 付费 |
| **视频下载** | 不需要 |
| **录屏功能** | 不需要 |
| **音频均衡器** | 不需要 |

---

## 4. 功能矩阵总结

| 类别 | 支持数 | 不支持数 |
|------|--------|----------|
| 基础播放 | 7 | 0 |
| 多格式 | 10 | 0 |
| 字幕 | 10 | 4 |
| 网络播放 | 4 | 0 |
| 系统集成 | 6 | 0 |
| 播放器控制 | 5 | 0 |
| **总计** | **42** | **4** |

---

## 5. KSPlayer GPL vs LGPL 对比

| 功能 | GPL (免费) | LGPL (付费) |
|------|------------|-------------|
| **4K 播放** | ✅ | ✅ |
| **8K 播放** | ❌ | ✅ |
| **120FPS** | ❌ | ✅ |
| **AV1 硬解** | ❌ | ✅ |
| **Dolby AC-4** | ❌ | ✅ |
| **FFmpeg 版本** | 6.1.0 | 8.0.1 |
| **高级字幕** | ❌ | ✅ |
| **项目要求** | 必须开源 | 可闭源 |

**结论**：Vly 用 GPL 版本，**4K 及以下完全够用**。

---

## 6. 非功能需求

### 6.1 性能需求

| 指标 | 要求 |
|------|------|
| 启动时间 | < 2秒 |
| 视频加载时间 | < 1秒 (本地) |
| 内存占用 | < 100MB (1080p) |
| CPU 占用 | < 30% (正常播放) |

### 6.2 兼容性

| 平台 | 最低版本 |
|------|----------|
| macOS | 12.0 Monterey |
| iOS | 15.0 |
| Xcode | 15.0 |

### 6.3 许可证

| 组件 | 许可证 |
|------|--------|
| **Vly 项目** | **GPL 3.0** |
| KSPlayer | GPL 3.0 |
| FFmpeg | LGPL 2.1 |

---

## 7. 相关文档

- [架构设计](../01-Architecture/README.md)
- [UI/UX 设计](../03-UI-UX/DESIGN.md)
- [数据模型](../04-Data-Models/MODELS.md)
- [KSPlayer 集成问题](../06-Research/KSPLAYER_INTEGRATION_ISSUE.md)

---

**文档版本**: 2.0  
**最后更新**: 2026-02-07
